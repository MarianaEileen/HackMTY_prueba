<div class="max-w-md mx-auto bg-white p-4 rounded-lg shadow-md">
  <h2 class="text-xl font-semibold text-slate-800 mb-4 text-center">Live Expiry Scanner</h2>
  <div class="relative w-full aspect-square bg-slate-800 rounded-lg shadow-inner overflow-hidden">
    
    <video #videoEl autoplay playsinline muted class="absolute top-0 left-0 w-full h-full"></video>
    <canvas #canvasEl class="absolute top-0 left-0 w-full h-full pointer-events-none"></canvas>

    @if (!isScanning() && !error()) {
      <div class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-60 z-10">
        <button (click)="startScan()" class="px-6 py-3 bg-sky-600 text-white font-bold rounded-lg shadow-lg hover:bg-sky-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 focus:ring-offset-slate-800">
          Start Scanner
        </button>
      </div>
    }

    @if (isScanning()) {
        <div class="absolute top-2 right-2 z-20">
            <button (click)="stopScan()" class="p-2 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-slate-800">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 10h6v4H9v-4z" />
                </svg>
            </button>
        </div>
    }

    @if (error()) {
      <div class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-80 text-white p-4 z-10">
        <h3 class="font-bold text-red-400">Scan Error</h3>
        <p class="text-sm text-center">{{ error() }}</p>
         <button (click)="startScan()" class="mt-4 px-4 py-2 bg-slate-600 text-white font-bold rounded-lg hover:bg-slate-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-slate-500">
          Try Again
        </button>
      </div>
    }
  </div>
   <p class="text-xs text-slate-500 mt-2 text-center">Point camera at a QR code.</p>
</div>